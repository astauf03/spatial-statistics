{
  "hash": "a3a9fe835ee5077eb0dc90d35444116b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Logistic and Multinomial Logistic Regression\nauthor: \"Alex Stauffer, Jun Luu, Tess Vu\"\nformat: html\neditor: visual\n---\n\n**Model: Regressing binary dependent variable, `DRINKING_D`, on the following binary and continuous predictors: `FATAL_OR_M`, `OVERTURNED`, `CELL_PHONE`, `SPEEDING`, `AGGRESSIVE`, `DRIVER1617`, `DRIVER65PLUS`, `PCTBACHMOR`, and `MEDHHINC`.**\n\nPrior to running any of the analyses, be sure to set the working directory using the `setwd` command, install the relevant R packages using the `install.packages` command, and load the relevant packages using the `library` command.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(aod)\nlibrary(ggplot2)\n#library(rms)\nlibrary(gmodels)\nlibrary(nnet)\nlibrary(DAAG)\nlibrary(ROCR)\nlibrary(xtable)\nlibrary(kableExtra)\nlibrary(ROCR)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:kableExtra':\n\n    group_rows\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\noptions(scipen = 999)\n```\n:::\n\n\n*2.* Import the file `logistic_regression.csv` into R using the `read.csv` command. Now, you are ready to do some exploratory analyses.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncdc_data <- read.csv(\"data/logistic_regression.csv\")\n\nhead(cdc_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        CRN DRINKING_D COLLISION_ FATAL_OR_M OVERTURNED CELL_PHONE SPEEDING\n1 200806719          0          7          0          0          0        0\n2 200807695          0          7          1          0          0        0\n3 200808809          0          8          0          0          0        0\n4 200809857          0          5          0          0          0        0\n5 200812736          0          1          0          0          0        0\n6 200907381          1          7          1          0          0        0\n  AGGRESSIVE DRIVER1617 DRIVER65PLUS      AREAKEY PCTBACHMOR MEDHHINC\n1          0          0            0 421010001001    64.4737    49107\n2          1          0            0 421010001001    64.4737    49107\n3          0          0            0 421010001001    64.4737    49107\n4          1          0            0 421010001001    64.4737    49107\n5          0          0            0 421010001001    64.4737    49107\n6          0          0            1 421010001001    64.4737    49107\n```\n\n\n:::\n:::\n\n\n*2.a.* Using the table and prop.table commands, tabulate the dependent variable, `DRINKING_D.`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDRINKING_D.counts <- table(cdc_data$DRINKING_D)\n\nDRINKING_D.proportions <- prop.table(DRINKING_D.counts)\n\ndrink_summary_matrix <- rbind(\n    Count = as.numeric(DRINKING_D.counts),\n    Proportion = as.numeric(DRINKING_D.proportions)\n)\n\ncolnames(drink_summary_matrix) <- c(\"No Alcohol\", \"Alcohol\")\n\nformatted_counts <- format(DRINKING_D.counts, big.mark = \",\")\n\nformatted_proportions <- format(round(DRINKING_D.proportions, 2), nsmall = 2)\n\ndrink_summary_df <- data.frame(\n    Metric = c(\"<b>Count</b>\", \"<b>Proportion</b>\"),\n    No_Alcohol = c(formatted_counts[1], formatted_proportions[1]),\n    Alcohol = c(formatted_counts[2], formatted_proportions[2]),\n    stringsAsFactors = FALSE\n)\n\ndrink_summary_df <- drink_summary_df %>%\n  rename(\"No Alcohol\" = \"No_Alcohol\")\ndrink_summary_df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Metric No Alcohol Alcohol\n1      <b>Count</b>     40,879   2,485\n2 <b>Proportion</b>       0.94    0.06\n```\n\n\n:::\n\n```{.r .cell-code}\n# 4. Generate the kable table\ndrink_table <- kbl(drink_summary_df,\n    caption = \"Summary of Alcohol Consumption\",\n    align = \"c\",\n    escape = FALSE\n  ) %>%\n  kable_styling(\n    bootstrap_options = \"striped\",\n    full_width = F\n  ) %>%\n  row_spec(0, bold = T)\ndrink_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary of Alcohol Consumption</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;font-weight: bold;\"> Metric </th>\n   <th style=\"text-align:center;font-weight: bold;\"> No Alcohol </th>\n   <th style=\"text-align:center;font-weight: bold;\"> Alcohol </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> <b>Count</b> </td>\n   <td style=\"text-align:center;\"> 40,879 </td>\n   <td style=\"text-align:center;\"> 2,485 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> <b>Proportion</b> </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Save as HTML file.\n#save_kable(drink_table, \"drink_table.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"drink_table.html\", \"drink_table.png\")\n```\n:::\n\n\nIn your report, in addition to the counts that you can obtain with the table command, you will be asked to report the proportion of crashes that involved a drunk driver using the prop.table command as above.\n\n*2.b.* Using the CrossTable command in the gmodels library, examine the cross-tabulations between the dependent variable, `DRINKING_D`, and the following binary predictor variables: `FATAL_OR_M`, `OVERTURNED`, `CELL_PHONE`, `SPEEDING`, `AGGRESSIVE`, `DRIVER1617`, and `DRIVER65PLUS`.\n\n*2.b.i.* For the first predictor (`FATAL_OR_M`), record the number and percentage of 1-responses (i.e., fatalities or major injuries) for both categories of the variable `DRINKING_D`, as well as the total number of 1-responses (i.e., fatalities or major injuries) in the data set. That is, how many fatalities or major injuries were there when the driver wasn‚Äôt inebriated, when the driver was inebriated, and altogether?\n\n*2.b.ii.* Repeat step *2.b.i* above for the rest of the binary predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# I made a function to loop through it so I don't have to do this 7 separate times.\n# Create predictor vector.\npredictors <- c(\n  \"FATAL_OR_M\", \"OVERTURNED\", \"CELL_PHONE\",\n  \"SPEEDING\", \"AGGRESSIVE\",\n  \"DRIVER1617\", \"DRIVER65PLUS\"\n  )\n\n# Create an empty results dataframe.\nbinary_results <- data.frame(\n  Predictor = character(),\n  Drink0_Count_1 = numeric(),\n  Drink1_Count_1 = numeric(),\n  Total_1 = numeric(),\n  ChiSq = numeric(),\n  p_value = numeric(),\n  stringsAsFactors = FALSE\n)\n\n# Loop through each predictor.\nfor (var in predictors) {\n  \n  cat(\"=======================================================\\n\")\n  cat(\"PREDICTOR:\", var, \"\\n\")\n\n  # Build 2x2 table.\n  tab <- table(cdc_data$DRINKING_D, cdc_data[[var]])\n  print(tab)\n  \n  # Row percentages.\n  cat(\"\\nRow percentages (within DRINKING_D):\\n\")\n  print(round(prop.table(tab, 1), 4))\n  \n  # Count the number of 1's.\n  total_ones <- sum(cdc_data[[var]] == 1)\n  cat(\"\\nTotal number of\", var, \"= 1 in dataset:\", total_ones, \"\\n\")\n  \n  # Chi-square test.\n  test <- chisq.test(tab, correct = FALSE)\n  cat(\"\\nChi-square statistic:\", test$statistic,\n      \"\\nDegrees of freedom:\", test$parameter,\n      \"\\np-value:\", test$p.value, \"\\n\")\n  \n  # Add row to results dataframe.\n  binary_results <- rbind(\n    binary_results,\n    data.frame(\n      Predictor = var,\n      Drink0_Count_1 = tab[\"0\", \"1\"],\n      Drink1_Count_1 = tab[\"1\", \"1\"],\n      Total_1 = total_ones,\n      ChiSq = unname(test$statistic),\n      p_value = test$p.value\n    )\n  )\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=======================================================\nPREDICTOR: FATAL_OR_M \n   \n        0     1\n  0 39698  1181\n  1  2297   188\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.9711 0.0289\n  1 0.9243 0.0757\n\nTotal number of FATAL_OR_M = 1 in dataset: 1369 \n\nChi-square statistic: 167.5615 \nDegrees of freedom: 1 \np-value: 0.00000000000000000000000000000000000002522202 \n=======================================================\nPREDICTOR: OVERTURNED \n   \n        0     1\n  0 40267   612\n  1  2375   110\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.9850 0.0150\n  1 0.9557 0.0443\n\nTotal number of OVERTURNED = 1 in dataset: 722 \n\nChi-square statistic: 122.788 \nDegrees of freedom: 1 \np-value: 0.0000000000000000000000000001551762 \n=======================================================\nPREDICTOR: CELL_PHONE \n   \n        0     1\n  0 40453   426\n  1  2457    28\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.9896 0.0104\n  1 0.9887 0.0113\n\nTotal number of CELL_PHONE = 1 in dataset: 454 \n\nChi-square statistic: 0.162071 \nDegrees of freedom: 1 \np-value: 0.6872569 \n=======================================================\nPREDICTOR: SPEEDING \n   \n        0     1\n  0 39618  1261\n  1  2225   260\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.9692 0.0308\n  1 0.8954 0.1046\n\nTotal number of SPEEDING = 1 in dataset: 1521 \n\nChi-square statistic: 376.7808 \nDegrees of freedom: 1 \np-value: 0.000000000000000000000000000000000000000000000000000000000000000000000000000000000006249562 \n=======================================================\nPREDICTOR: AGGRESSIVE \n   \n        0     1\n  0 22357 18522\n  1  1569   916\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.5469 0.4531\n  1 0.6314 0.3686\n\nTotal number of AGGRESSIVE = 1 in dataset: 19438 \n\nChi-square statistic: 67.60186 \nDegrees of freedom: 1 \np-value: 0.000000000000000200079 \n=======================================================\nPREDICTOR: DRIVER1617 \n   \n        0     1\n  0 40205   674\n  1  2473    12\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.9835 0.0165\n  1 0.9952 0.0048\n\nTotal number of DRIVER1617 = 1 in dataset: 686 \n\nChi-square statistic: 20.45167 \nDegrees of freedom: 1 \np-value: 0.000006115619 \n=======================================================\nPREDICTOR: DRIVER65PLUS \n   \n        0     1\n  0 36642  4237\n  1  2366   119\n\nRow percentages (within DRINKING_D):\n   \n         0      1\n  0 0.8964 0.1036\n  1 0.9521 0.0479\n\nTotal number of DRIVER65PLUS = 1 in dataset: 4356 \n\nChi-square statistic: 80.6047 \nDegrees of freedom: 1 \np-value: 0.000000000000000000275703 \n```\n\n\n:::\n:::\n\n\n*2.b.iii.* In your report, you will be asked to present the cross-tabulations from *2.b.i* and *2.b.ii* in a table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Build summary table.\nbinary_summary <- data.frame(\n  Predictor = character(),\n  DRINKING_D = integer(),\n  Count_1 = integer(),\n  Percent_1 = numeric(),\n  Total_1 = integer(),\n  stringsAsFactors = FALSE\n)\n\nfor (var in predictors) {\n  tab <- table(DRINKING_D = cdc_data$DRINKING_D,\n               Predictor   = cdc_data[[var]])\n  row_props <- prop.table(tab, 1)\n  total_1 <- sum(tab[, \"1\"])\n\n  for (d in rownames(tab)) {\n    binary_summary <- rbind(\n      binary_summary,\n      data.frame(\n        Predictor  = var,\n        DRINKING_D = as.integer(d),\n        Count_1    = as.integer(tab[d, \"1\"]),\n        Percent_1  = 100 * as.numeric(row_props[d, \"1\"]),\n        Total_1    = total_1\n      )\n    )\n  }\n}\n\nbinary_summary$DRINKING_D <- ifelse(\n  binary_summary$DRINKING_D == 0, \"No Alcohol\", \"Alcohol\"\n)\n\nkable(binary_summary, digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|Predictor    |DRINKING_D | Count_1| Percent_1| Total_1|\n|:------------|:----------|-------:|---------:|-------:|\n|FATAL_OR_M   |No Alcohol |    1181|      2.89|    1369|\n|FATAL_OR_M   |Alcohol    |     188|      7.57|    1369|\n|OVERTURNED   |No Alcohol |     612|      1.50|     722|\n|OVERTURNED   |Alcohol    |     110|      4.43|     722|\n|CELL_PHONE   |No Alcohol |     426|      1.04|     454|\n|CELL_PHONE   |Alcohol    |      28|      1.13|     454|\n|SPEEDING     |No Alcohol |    1261|      3.08|    1521|\n|SPEEDING     |Alcohol    |     260|     10.46|    1521|\n|AGGRESSIVE   |No Alcohol |   18522|     45.31|   19438|\n|AGGRESSIVE   |Alcohol    |     916|     36.86|   19438|\n|DRIVER1617   |No Alcohol |     674|      1.65|     686|\n|DRIVER1617   |Alcohol    |      12|      0.48|     686|\n|DRIVER65PLUS |No Alcohol |    4237|     10.36|    4356|\n|DRIVER65PLUS |Alcohol    |     119|      4.79|    4356|\n\n\n:::\n:::\n\n\n*2.b.iv.* Prior to doing predictive modeling, statisticians often use the Chi-Square (œá2) test to determine whether the distribution of one categorical variable varies with respect to the values of another categorical variable. If we were to look at a cross-tabulation of the variables `DRINKING_D` and `FATAL_OR_M`, the null and alternative hypotheses for the œá2 test would be as follows:\n\n*H0:* The proportion of fatalities for crashes that involve drunk drivers is the same as the proportion of fatalities for crashes that don‚Äôt involve drunk drivers.\n\nvs.\n\n*Ha:* The proportion of fatalities for crashes that involve drunk drivers is different than the proportion of fatalities for crashes that don‚Äôt involve drunk drivers.\n\nAs usual, a high value of the œá2 statistic, and a p-value lower than 0.05 suggest that there‚Äôs evidence to reject the null hypothesis in favor of the alternative, and that there‚Äôs an association between drunk driving and crash fatalities.\n\n*2.b.iv.1.* To carry out the œá2 test in R to test the hypothesis above, you would use the syntax `CrossTable(cdc_data$FATAL_OR_M, cdc_data$DRINKING_D, prop.r = FALSE, prop.t = FALSE, prop.chisq = FALSE, chisq = TRUE)`. The œá2 results will appear below the cross-tabulation table that you have seen in *2.b.i* above. Report the results without the Yates Continuity Correction.\n\n*2.b.iv.2.* Modifying the syntax in *2.b.iv.1* above, run the œá2 test examining the association between the dependent variable and the remaining binary predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi_results <- data.frame(\n  Predictor = predictors,\n  Chi_sq = NA_real_,\n  df = 1,\n  p_value = NA_real_\n)\n\nfor (i in seq_along(predictors)) {\n  var <- predictors[i]\n  tab <- table(cdc_data$DRINKING_D, cdc_data[[var]])\n  test <- chisq.test(tab, correct = FALSE)\n  chi_results$Chi_sq[i] <- test$statistic\n  chi_results$p_value[i] <- test$p.value\n}\n\nkable(chi_results, digits = 4)\n```\n\n::: {.cell-output-display}\n\n\n|Predictor    |   Chi_sq| df| p_value|\n|:------------|--------:|--:|-------:|\n|FATAL_OR_M   | 167.5615|  1|  0.0000|\n|OVERTURNED   | 122.7880|  1|  0.0000|\n|CELL_PHONE   |   0.1621|  1|  0.6873|\n|SPEEDING     | 376.7808|  1|  0.0000|\n|AGGRESSIVE   |  67.6019|  1|  0.0000|\n|DRIVER1617   |  20.4517|  1|  0.0000|\n|DRIVER65PLUS |  80.6047|  1|  0.0000|\n\n\n:::\n:::\n\n\n*2.b.iv.3.* In the table *2.b.iii* above, add another column called ‚Äúœá2 p-value‚Äù. For each row, present the p-value from the corresponding œá2 test.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinary_summary2 <- merge(binary_summary, chi_results, by = \"Predictor\")\n\nkable(binary_summary2, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|Predictor    |DRINKING_D | Count_1| Percent_1| Total_1|  Chi_sq| df| p_value|\n|:------------|:----------|-------:|---------:|-------:|-------:|--:|-------:|\n|AGGRESSIVE   |No Alcohol |   18522|    45.309|   19438|  67.602|  1|   0.000|\n|AGGRESSIVE   |Alcohol    |     916|    36.861|   19438|  67.602|  1|   0.000|\n|CELL_PHONE   |No Alcohol |     426|     1.042|     454|   0.162|  1|   0.687|\n|CELL_PHONE   |Alcohol    |      28|     1.127|     454|   0.162|  1|   0.687|\n|DRIVER1617   |No Alcohol |     674|     1.649|     686|  20.452|  1|   0.000|\n|DRIVER1617   |Alcohol    |      12|     0.483|     686|  20.452|  1|   0.000|\n|DRIVER65PLUS |No Alcohol |    4237|    10.365|    4356|  80.605|  1|   0.000|\n|DRIVER65PLUS |Alcohol    |     119|     4.789|    4356|  80.605|  1|   0.000|\n|FATAL_OR_M   |No Alcohol |    1181|     2.889|    1369| 167.562|  1|   0.000|\n|FATAL_OR_M   |Alcohol    |     188|     7.565|    1369| 167.562|  1|   0.000|\n|OVERTURNED   |No Alcohol |     612|     1.497|     722| 122.788|  1|   0.000|\n|OVERTURNED   |Alcohol    |     110|     4.427|     722| 122.788|  1|   0.000|\n|SPEEDING     |No Alcohol |    1261|     3.085|    1521| 376.781|  1|   0.000|\n|SPEEDING     |Alcohol    |     260|    10.463|    1521| 376.781|  1|   0.000|\n\n\n:::\n:::\n\n\n*2.b.iv.3.a.* Note, however, that in practice, statisticians generally present not just the p-value, but also the value of the œá2 statistic and the degrees of freedom, which is the parameter of the œá2 distribution. The degrees of freedom is calculated as (R ‚àí 1)(C ‚àí 1), where R is the number of rows in the cross-tabulation table and C is the number of columns in the cross-tabulation table. Said differently, R is the number of categories of the first variable and C is the number of categories in the second variable. Here, because we are cross-tabulating two binary variables, both R and C are 2, and df = (R ‚àí 1)(C ‚àí 1) = 1.\n\n*2.c.* Now, let‚Äôs examine whether the means of the two continuous predictors seem to differ for the different levels of the dependent variable. To do this, calculate the group means (and standard deviations) of both predictors (`PCTBACHMOR` and `MEDHHINC`) for crashes that involve drunk drivers and crashes that don‚Äôt.\n\n*2.c.i.* In order to do this in R, use the `tapply` command. For instance, if you want to calculate the average values of the variable `PCTBACHMOR` for crashes that involve drunk drivers and crashes that don‚Äôt, you would use the following syntax: `tapply(cdc_data$PCTBACHMOR, cdc_data$DRINKING_D, mean)`. To calculate the standard deviations of the variable `PCTBACHMOR` for crashes that involve drunk drivers and crashes that don‚Äôt, you would use the following syntax: `tapply(cdc_data$PCTBACHMOR, cdc_data$DRINKING_D, sd)`.\n\n*2.c.ii.* Present your results in a table.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontinuous_vars <- c(\"PCTBACHMOR\", \"MEDHHINC\")\n\nmean_sd_table <- do.call(rbind, lapply(continuous_vars, function(v) {\n  data.frame(\n    Predictor = v,\n    Group = c(\"No Alcohol\", \"Alcohol\"),\n    Mean = tapply(cdc_data[[v]], cdc_data$DRINKING_D, mean),\n    SD = tapply(cdc_data[[v]], cdc_data$DRINKING_D, sd)\n  )\n}))\n\nkable(mean_sd_table, digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|   |Predictor  |Group      |     Mean|       SD|\n|:--|:----------|:----------|--------:|--------:|\n|0  |PCTBACHMOR |No Alcohol |    16.57|    18.21|\n|1  |PCTBACHMOR |Alcohol    |    16.61|    18.72|\n|01 |MEDHHINC   |No Alcohol | 31483.05| 16930.10|\n|11 |MEDHHINC   |Alcohol    | 31998.75| 17810.50|\n\n\n:::\n:::\n\n\n*2.c.iii.* Recall from introductory statistics classes that in order to compare the mean value of a continuous variable for two independent groups, statisticians usually employ a test that‚Äôs called the independent samples t-test. For example, we can see whether the average `PCTBACHMOR` values are statistically significantly different for crashes that involve drunk drivers and crashes that don‚Äôt. The null and alternative hypotheses for the independent samples t-test would be as follows:\n\n*H0:* average values of the variable `PCTBACHMOR` are the same for crashes that involve drunk drivers and crashes that don‚Äôt.\n\nvs.\n\n*Ha:* average values of the variable `PCTBACHMOR` are different for crashes that involve drunk drivers and crashes that don‚Äôt.\n\nA high value of the t-statistic, and a p-value lower than 0.05 suggest that there‚Äôs evidence to reject the null hypothesis in favor of the alternative.\n\n*2.c.iii.1.* To carry out the t-test in R to test the hypothesis above, you would use the syntax `t.test(mydata$PCTBACHMOR~mydata$DRINKING_D)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_PCTB <- t.test(cdc_data$PCTBACHMOR ~ cdc_data$DRINKING_D)\nt_MEDH <- t.test(cdc_data$MEDHHINC ~ cdc_data$DRINKING_D)\n\nt_table <- data.frame(\n  Predictor = c(\"PCTBACHMOR\", \"MEDHHINC\"),\n  t_stat = c(t_PCTB$statistic, t_MEDH$statistic),\n  df = c(t_PCTB$parameter, t_MEDH$parameter),\n  p_value = c(t_PCTB$p.value, t_MEDH$p.value)\n)\n\nkable(t_table, digits = 4)\n```\n\n::: {.cell-output-display}\n\n\n|Predictor  |  t_stat|       df| p_value|\n|:----------|-------:|--------:|-------:|\n|PCTBACHMOR | -0.1084| 2777.542|  0.9137|\n|MEDHHINC   | -1.4053| 2763.870|  0.1600|\n\n\n:::\n:::\n\n\n*2.c.iii.2.* Repeat the t-test for the variable `MEDHHINC.`\n\n*2.c.iii.3.* In the table *2.c.ii* above, add another column called ‚Äút-test pvalue‚Äù. For each row, present the p-value from the corresponding t-test.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_sd_table2 <- merge(mean_sd_table, t_table, by = \"Predictor\")\n\nkable(mean_sd_table2, digits = 4)\n```\n\n::: {.cell-output-display}\n\n\n|Predictor  |Group      |       Mean|         SD|  t_stat|       df| p_value|\n|:----------|:----------|----------:|----------:|-------:|--------:|-------:|\n|MEDHHINC   |No Alcohol | 31483.0547| 16930.1016| -1.4053| 2763.870|  0.1600|\n|MEDHHINC   |Alcohol    | 31998.7529| 17810.4973| -1.4053| 2763.870|  0.1600|\n|PCTBACHMOR |No Alcohol |    16.5699|    18.2143| -0.1084| 2777.542|  0.9137|\n|PCTBACHMOR |Alcohol    |    16.6117|    18.7209| -0.1084| 2777.542|  0.9137|\n\n\n:::\n:::\n\n\n*2.c.iii.3.a.* Note, however, that in practice, statisticians generally present not just the p-value, but also the value of the t-statistic and the degrees of freedom.\n\n*2.d.* Using the instructions from Assignment 1, examine the Pearson correlations between all the predictors (both binary and continuous). Is there evidence of severe multicollinearity here? (Be sure the appropriate R library is loaded).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Define all predictors (binary and continuous)\nall_predictors <- c(\n  predictors,\n  \"MEDHHINC\",\n  \"PCTBACHMOR\"\n)\n\nlibrary(ggcorrplot)\n\n# Calculate correlation matrix\ncorr_matrix <- cor(cdc_data[, all_predictors], use = \"complete.obs\")\n\n# Create correlation plot\npearson_corr <- ggcorrplot(corr_matrix, \n           hc.order = TRUE,\n           type = \"lower\",\n           lab = TRUE,\n           lab_size = 3,\n           colors = c(\"#0072B2\", \"white\", \"#D55E00\"),\n           title = \"Pearson Correlation Matrix of Predictors\") +\n  theme(\n    axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n    axis.text.y = element_text(size = 8),\n    plot.title = element_text(hjust = 0.5, size = 12)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\n‚Ñπ Please use tidy evaluation idioms with `aes()`.\n‚Ñπ See also `vignette(\"ggplot2-in-packages\")` for more information.\n‚Ñπ The deprecated feature was likely used in the ggcorrplot package.\n  Please report the issue at <https://github.com/kassambara/ggcorrplot/issues>.\n```\n\n\n:::\n\n```{.r .cell-code}\npearson_corr\n```\n\n::: {.cell-output-display}\n![](logistic_regression_files/figure-html/pearson correlation-1.png){width=1800}\n:::\n\n```{.r .cell-code}\n#ggsave(\"correlation_matrix.png\", plot = pearson_corr, width = 6, height = 6, dpi = 300)\n```\n:::\n\n\n*3.* Now that we‚Äôre done with exploratory analysis, we are ready to proceed to running the logistic regression.\n\n*3.a.* Using the `glm` command for logistic regression (as shown in the slides), regress the `DRINKING_D` variable on the following predictors: `FATAL_OR_M`, `OVERTURNED`, `CELL_PHONE`, `SPEEDING`, `AGGRESSIVE`, `DRIVER1617`, `DRIVER65PLUS`, `PCTBACHMOR`, and `MEDHHINC`.\n\n*3.a.i.* Use the summary command to examine the results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogit_full <- glm(DRINKING_D ~\n                    FATAL_OR_M + OVERTURNED + CELL_PHONE +\n                    SPEEDING + AGGRESSIVE + DRIVER1617 + DRIVER65PLUS +\n                    PCTBACHMOR + MEDHHINC,\n                  family = binomial,\n                  data = cdc_data\n                  )\n\nsummary(logit_full)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = DRINKING_D ~ FATAL_OR_M + OVERTURNED + CELL_PHONE + \n    SPEEDING + AGGRESSIVE + DRIVER1617 + DRIVER65PLUS + PCTBACHMOR + \n    MEDHHINC, family = binomial, data = cdc_data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.1945  -0.3693  -0.3471  -0.2731   3.0099  \n\nCoefficients:\n                 Estimate   Std. Error z value             Pr(>|z|)    \n(Intercept)  -2.732506616  0.045875659 -59.563 < 0.0000000000000002 ***\nFATAL_OR_M    0.814013802  0.083806924   9.713 < 0.0000000000000002 ***\nOVERTURNED    0.928921376  0.109166324   8.509 < 0.0000000000000002 ***\nCELL_PHONE    0.029550085  0.197777821   0.149               0.8812    \nSPEEDING      1.538975665  0.080545894  19.107 < 0.0000000000000002 ***\nAGGRESSIVE   -0.596915946  0.047779238 -12.493 < 0.0000000000000002 ***\nDRIVER1617   -1.280295964  0.293147168  -4.367 0.000012572447127933 ***\nDRIVER65PLUS -0.774664640  0.095858315  -8.081 0.000000000000000641 ***\nPCTBACHMOR   -0.000370634  0.001296387  -0.286               0.7750    \nMEDHHINC      0.000002804  0.000001341   2.091               0.0365 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 19036  on 43363  degrees of freedom\nResidual deviance: 18340  on 43354  degrees of freedom\nAIC: 18360\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n\n```{.r .cell-code}\nfull_coefs <- summary(logit_full)$coefficients\nOR2 <- exp(coef(logit_full))\nCI2 <- exp(confint(logit_full))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWaiting for profiling to be done...\n```\n\n\n:::\n\n```{.r .cell-code}\nfull_logit_results <- cbind(\n  full_coefs,\n  OR = OR2,\n  CI_low = CI2[,1],\n  CI_high = CI2[,2]\n)\n\n# Create table.\nfull_model <- kbl(full_logit_results, \n    digits = 2,\n    # Rename columns.\n    col.names = c(\"Estimate\", \"Standard Error\", \"Z-Value\", \"P-Value\", \"Odds Ratio\", \"2.5% CI\", \"97.5% CI\"),\n    align = \"c\",\n    caption = \"Full Logistic Regression Model (Binary Predictors)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F) %>%\n  column_spec(1, bold = T) %>%\n  footnote(\n    general = c(\n      \"<i>FATAL_OR_M:</i> Crash resulted in fatality or major injury.\",\n      \"<i>OVERTURNED:</i> Crash involved an overturned vehicle.\",\n      \"<i>CELL_PHONE:</i> Driver was using cell phone.\",\n      \"<i>SPEEDING:</i> Crash involved speeding car.\",\n      \"<i>AGGRESSIVE:</i> Crash involved aggressive driving.\",\n      \"<i>DRIVER1617:</i> Crash involved at least one driver who was 16 or 17 years old.\",\n      \"<i>DRIVER65PLUS:</i> Crash involved at least one driver who was at least 65 years old.\",\n      \"<i>PCTBACHMOR:</i> % of individuals 25 years of age or older who have at least a bachelor‚Äôs degree.\",\n      \"<i>MEDHHINC:</i> Median household income.\"\n    ),\n    general_title = \"Variable Definitions:\",\n    footnote_as_chunk = FALSE, \n    escape = FALSE # To allow HTML formatting.\n  )\n  \n  # Highlight significant p-values.\n  #row_spec(which(reduced_logit_results[, \"Pr(>|z|)\"] < 0.05), bold = T)\n\nfull_model\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Full Logistic Regression Model (Binary Predictors)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> Estimate </th>\n   <th style=\"text-align:center;\"> Standard Error </th>\n   <th style=\"text-align:center;\"> Z-Value </th>\n   <th style=\"text-align:center;\"> P-Value </th>\n   <th style=\"text-align:center;\"> Odds Ratio </th>\n   <th style=\"text-align:center;\"> 2.5% CI </th>\n   <th style=\"text-align:center;\"> 97.5% CI </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> (Intercept) </td>\n   <td style=\"text-align:center;\"> -2.73 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> -59.56 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> FATAL_OR_M </td>\n   <td style=\"text-align:center;\"> 0.81 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 9.71 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 2.26 </td>\n   <td style=\"text-align:center;\"> 1.91 </td>\n   <td style=\"text-align:center;\"> 2.65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> OVERTURNED </td>\n   <td style=\"text-align:center;\"> 0.93 </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n   <td style=\"text-align:center;\"> 8.51 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 2.53 </td>\n   <td style=\"text-align:center;\"> 2.03 </td>\n   <td style=\"text-align:center;\"> 3.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> CELL_PHONE </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.20 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.88 </td>\n   <td style=\"text-align:center;\"> 1.03 </td>\n   <td style=\"text-align:center;\"> 0.68 </td>\n   <td style=\"text-align:center;\"> 1.49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> SPEEDING </td>\n   <td style=\"text-align:center;\"> 1.54 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 19.11 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 4.66 </td>\n   <td style=\"text-align:center;\"> 3.97 </td>\n   <td style=\"text-align:center;\"> 5.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AGGRESSIVE </td>\n   <td style=\"text-align:center;\"> -0.60 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> -12.49 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.55 </td>\n   <td style=\"text-align:center;\"> 0.50 </td>\n   <td style=\"text-align:center;\"> 0.60 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> DRIVER1617 </td>\n   <td style=\"text-align:center;\"> -1.28 </td>\n   <td style=\"text-align:center;\"> 0.29 </td>\n   <td style=\"text-align:center;\"> -4.37 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> DRIVER65PLUS </td>\n   <td style=\"text-align:center;\"> -0.77 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> -8.08 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 0.55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> PCTBACHMOR </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> -0.29 </td>\n   <td style=\"text-align:center;\"> 0.77 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> MEDHHINC </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 2.09 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Variable Definitions:</span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>FATAL_OR_M:</i> Crash resulted in fatality or major injury.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>OVERTURNED:</i> Crash involved an overturned vehicle.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>CELL_PHONE:</i> Driver was using cell phone.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>SPEEDING:</i> Crash involved speeding car.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>AGGRESSIVE:</i> Crash involved aggressive driving.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>DRIVER1617:</i> Crash involved at least one driver who was 16 or 17 years old.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>DRIVER65PLUS:</i> Crash involved at least one driver who was at least 65 years old.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>PCTBACHMOR:</i> % of individuals 25 years of age or older who have at least a bachelor‚Äôs degree.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>MEDHHINC:</i> Median household income.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Save as HTML file.\n#save_kable(full_model, \"full_model.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"full_model.html\", \"full_model.png\")\n```\n:::\n\n\n*3.a.ii.* For each predictor, also compute the odds ratio and the 95% confidence interval (CI) using commands shown in the slides. Use the syntax presented on the slide titled ‚ÄòMerging Odds Ratios to ùõΩ Coefficients in R‚Äô to merge the odds ratios and CIs to the matrix that contains coefficients and p-values. Present the resulting (merged) matrix in your report.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoefs <- summary(logit_full)$coefficients\nOR <- exp(coef(logit_full))\nlower <- exp(coef(logit_full) - 1.96 * coefs[, \"Std. Error\"])\nupper <- exp(coef(logit_full) + 1.96 * coefs[, \"Std. Error\"])\n\nmerged <- cbind(coefs, OR, lower, upper)\n\nkable(merged, digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|             | Estimate| Std. Error| z value| Pr(>&#124;z&#124;)|    OR| lower| upper|\n|:------------|--------:|----------:|-------:|------------------:|-----:|-----:|-----:|\n|(Intercept)  |   -2.733|      0.046| -59.563|              0.000| 0.065| 0.059| 0.071|\n|FATAL_OR_M   |    0.814|      0.084|   9.713|              0.000| 2.257| 1.915| 2.660|\n|OVERTURNED   |    0.929|      0.109|   8.509|              0.000| 2.532| 2.044| 3.136|\n|CELL_PHONE   |    0.030|      0.198|   0.149|              0.881| 1.030| 0.699| 1.518|\n|SPEEDING     |    1.539|      0.081|  19.107|              0.000| 4.660| 3.979| 5.457|\n|AGGRESSIVE   |   -0.597|      0.048| -12.493|              0.000| 0.551| 0.501| 0.605|\n|DRIVER1617   |   -1.280|      0.293|  -4.367|              0.000| 0.278| 0.156| 0.494|\n|DRIVER65PLUS |   -0.775|      0.096|  -8.081|              0.000| 0.461| 0.382| 0.556|\n|PCTBACHMOR   |    0.000|      0.001|  -0.286|              0.775| 1.000| 0.997| 1.002|\n|MEDHHINC     |    0.000|      0.000|   2.091|              0.036| 1.000| 1.000| 1.000|\n\n\n:::\n:::\n\n\n*3.a.iii.* Using the syntax presented in the slides, calculate the sensitivity, specificity and misclassification rate for each of the following cut-off values: **0.02; 0.03; 0.05; 0.07; 0.08; 0.09; 0.10; 0.15; 0.20; 0.50** and present them in a table. In the table, highlight the cut-off value which has the lowest misclassification rate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncutoffs <- c(0.02, 0.03, 0.05, 0.07, 0.08, 0.09, 0.10, 0.15, 0.20, 0.50)\n\nphat <- logit_full$fitted.values\ny <- cdc_data$DRINKING_D\n\ncutoff_table <- data.frame(\n  Cutoff = cutoffs,\n  Sensitivity = NA,\n  Specificity = NA,\n  Misclass = NA\n)\n\nfor (i in seq_along(cutoffs)) {\n  \n  c <- cutoffs[i]\n  pred <- ifelse(phat >= c, 1, 0)\n  \n  TP <- sum(pred == 1 & y == 1)\n  TN <- sum(pred == 0 & y == 0)\n  FP <- sum(pred == 1 & y == 0)\n  FN <- sum(pred == 0 & y == 1)\n  \n  cutoff_table$Sensitivity[i] <- TP/(TP+FN)\n  cutoff_table$Specificity[i] <- TN/(TN+FP)\n  cutoff_table$Misclass[i] <- (FP+FN)/length(y)\n}\n\nkable(\n  cutoff_table,\n  digits = 3,\n  caption = \"Sensitivity, Specificity, and Misclassification Across Cutoffs\"\n)\n```\n\n::: {.cell-output-display}\n\n\nTable: Sensitivity, Specificity, and Misclassification Across Cutoffs\n\n| Cutoff| Sensitivity| Specificity| Misclass|\n|------:|-----------:|-----------:|--------:|\n|   0.02|       0.984|       0.058|    0.889|\n|   0.03|       0.981|       0.064|    0.884|\n|   0.05|       0.735|       0.469|    0.516|\n|   0.07|       0.221|       0.914|    0.126|\n|   0.08|       0.185|       0.939|    0.105|\n|   0.09|       0.168|       0.946|    0.099|\n|   0.10|       0.164|       0.948|    0.097|\n|   0.15|       0.104|       0.972|    0.078|\n|   0.20|       0.023|       0.995|    0.060|\n|   0.50|       0.002|       1.000|    0.057|\n\n\n:::\n:::\n\n\n: Sensitivity, Specificity, and Misclassification Table\n\n*3.a.iv.* Using the syntax presented in the slides, generate the ROC curve, and identify the optimal cut-off value. Be sure to export the image of the ROC curve (as you will be expected to present it in your report).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pROC)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nType 'citation(\"pROC\")' for a citation.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'pROC'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:gmodels':\n\n    ci\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    cov, smooth, var\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Create ROC object\nroc_obj <- roc(y, phat)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting levels: control = 0, case = 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting direction: controls < cases\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get AUC\nauc_value <- auc(roc_obj)\n\n# Plot with ggplot\nroc_curve <- ggroc(roc_obj, color = \"#0072B2\", size = 1.2) +\n  geom_abline(intercept = 1, slope = 1, linetype = \"dashed\", color = \"gray50\") +\n  annotate(\"text\", x = 0.25, y = 0.25, \n           label = paste(\"AUC =\", round(auc_value, 3)), \n           size = 5, fontface = \"bold\") +\n  labs(\n    title = \"ROC Curve\",\n    x = \"Specificity\",\n    y = \"Sensitivity\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10),\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n‚Ñπ The deprecated feature was likely used in the pROC package.\n  Please report the issue at <https://github.com/xrobin/pROC/issues>.\n```\n\n\n:::\n\n```{.r .cell-code}\nroc_curve\n```\n\n::: {.cell-output-display}\n![](logistic_regression_files/figure-html/ROC curve-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"roc_curve.png\", roc_curve, height = 6, width = 6, dpi = 300)\n```\n:::\n\n\n*3.a.v.* Using the syntax presented in the slides, calculate the area under the ROC curve.\n\n*3.b.* Re-run the model without the `PCTBACHMOR` and `MEDHHINC` terms. As in *3.a.i* and *3.a.ii* above, use the summary command to examine results, and calculate the odds ratio and the 95% confidence interval for each predictor. As in *3.a.ii* above, merge the odds ratios and confidence intervals to the matrix containing coefficients and p-values. Present the resulting (merged) matrix in your report.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogit_reduced <- glm(DRINKING_D ~\n                       FATAL_OR_M + OVERTURNED + CELL_PHONE +\n                       SPEEDING + AGGRESSIVE + DRIVER1617 + DRIVER65PLUS,\n                     data = cdc_data,\n                     family = binomial\n                     )\n\nsummary(logit_reduced)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = DRINKING_D ~ FATAL_OR_M + OVERTURNED + CELL_PHONE + \n    SPEEDING + AGGRESSIVE + DRIVER1617 + DRIVER65PLUS, family = binomial, \n    data = cdc_data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.1961  -0.3692  -0.3153  -0.2764   3.0093  \n\nCoefficients:\n             Estimate Std. Error z value             Pr(>|z|)    \n(Intercept)  -2.65190    0.02753 -96.324 < 0.0000000000000002 ***\nFATAL_OR_M    0.80932    0.08376   9.662 < 0.0000000000000002 ***\nOVERTURNED    0.93978    0.10903   8.619 < 0.0000000000000002 ***\nCELL_PHONE    0.03107    0.19777   0.157                0.875    \nSPEEDING      1.54032    0.08053  19.128 < 0.0000000000000002 ***\nAGGRESSIVE   -0.59365    0.04775 -12.433 < 0.0000000000000002 ***\nDRIVER1617   -1.27158    0.29311  -4.338  0.00001436374143265 ***\nDRIVER65PLUS -0.76646    0.09576  -8.004  0.00000000000000121 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 19036  on 43363  degrees of freedom\nResidual deviance: 18344  on 43356  degrees of freedom\nAIC: 18360\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n\n```{.r .cell-code}\nreduced_coefs <- summary(logit_reduced)$coefficients\nOR2 <- exp(coef(logit_reduced))\nCI2 <- exp(confint(logit_reduced))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWaiting for profiling to be done...\n```\n\n\n:::\n\n```{.r .cell-code}\nreduced_logit_results <- cbind(\n  reduced_coefs,\n  OR = OR2,\n  CI_low = CI2[,1],\n  CI_high = CI2[,2]\n)\n\n# Create table.\nreduced_model <- kbl(reduced_logit_results, \n    digits = 2,\n    # Rename columns.\n    col.names = c(\"Estimate\", \"Standard Error\", \"Z-Value\", \"P-Value\", \"Odds Ratio\", \"2.5% CI\", \"97.5% CI\"),\n    align = \"c\",\n    caption = \"Reduced Logistic Regression Model (Binary Predictors)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F) %>%\n  column_spec(1, bold = T) %>%\n  footnote(\n    general = c(\n      \"<i>FATAL_OR_M:</i> Crash resulted in fatality or major injury.\",\n      \"<i>OVERTURNED:</i> Crash involved an overturned vehicle.\",\n      \"<i>CELL_PHONE:</i> Driver was using cell phone.\",\n      \"<i>SPEEDING:</i> Crash involved speeding car.\",\n      \"<i>AGGRESSIVE:</i> Crash involved aggressive driving.\",\n      \"<i>DRIVER1617:</i> Crash involved at least one driver who was 16 or 17 years old.\",\n      \"<i>DRIVER65PLUS:</i> Crash involved at least one driver who was at least 65 years old.\"\n    ),\n    general_title = \"Variable Definitions:\",\n    footnote_as_chunk = FALSE, \n    escape = FALSE # To allow HTML formatting.\n  )\n  \n  # Highlight significant p-values.\n  #row_spec(which(reduced_logit_results[, \"Pr(>|z|)\"] < 0.05), bold = T)\n\n# Save as HTML file.\n#save_kable(reduced_model, \"reduced_model.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"reduced_model.html\", \"reduced_model.png\")\n```\n:::\n\n\n*3.c.* Compare the two models using the Akaike Information Criterion (AIC). The results are typically presented at the bottom of the logistic regression output. They may also be obtained using the `AIC` command. For instance, if the results obtained from the `glm` command for the first model are saved as `mylogit1` and the results from the second model are saved as `mylogit2`, the R syntax to obtain the AICs from both models would be `AIC(mylogit1, mylogit2)`. Here, recall that lower values of the AIC correspond to a better model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(logit_full, logit_reduced)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              df      AIC\nlogit_full    10 18359.63\nlogit_reduced  8 18360.47\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split data into No Alcohol and Alcohol.\nno_alcohol <- subset(binary_summary, DRINKING_D == \"No Alcohol\")\nalcohol <- subset(binary_summary, DRINKING_D == \"Alcohol\")\n\n# Create a wide dataframe with one row per predictor.\n# Extract the counts and percents from alcohol categories.\nwide_summary <- data.frame(\n  Predictor = no_alcohol$Predictor,\n  N_No = no_alcohol$Count_1,\n  Pct_No = no_alcohol$Percent_1,\n  N_Yes = alcohol$Count_1,\n  Pct_Yes = alcohol$Percent_1,\n  Total = no_alcohol$Total_1 \n)\n\n# Merge with the Chi-Square P-Values.\nfinal_table_data <- merge(wide_summary, chi_results[, c(\"Predictor\", \"p_value\")], \n                          by = \"Predictor\")\n\n# Re-order rows to match original predictor list.\nfinal_table_data <- final_table_data[match(predictors, final_table_data$Predictor), ]\n\n# Create table.\ncross_tab <- kbl(final_table_data, \n    col.names = c(\"Predictor\", \"N\", \"%\", \"N\", \"%\", \"Total\", \"Œß2 p-value\"),\n    align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n    digits = 2,\n    row.names = FALSE,\n    format.args = list(big.mark = \",\"),\n    caption = \"Cross-Tabulation of Predictors by Alcohol Involvement\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"No Alcohol Involved\\n(DRINKING_D = 0)\" = 2, \"Alcohol Involved\\n(DRINKING_D = 1)\" = 2, \" \" = 2)) %>%\n  column_spec(1, bold = TRUE) %>%\n  footnote(\n    general = c(\n      \"<i>FATAL_OR_M:</i> Crash resulted in fatality or major injury.\",\n      \"<i>OVERTURNED:</i> Crash involved an overturned vehicle.\",\n      \"<i>CELL_PHONE:</i> Driver was using cell phone.\",\n      \"<i>SPEEDING:</i> Crash involved speeding car.\",\n      \"<i>AGGRESSIVE:</i> Crash involved aggressive driving.\",\n      \"<i>DRIVER1617:</i> Crash involved at least one driver who was 16 or 17 years old.\",\n      \"<i>DRIVER65PLUS:</i> Crash involved at least one driver who was at least 65 years old.\"\n    ),\n    general_title = \"Variable Definitions:\",\n    footnote_as_chunk = FALSE, \n    escape = FALSE # To allow HTML formatting.\n  )\n\ncross_tab\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Cross-Tabulation of Predictors by Alcohol Involvement</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">No Alcohol Involved<br>(DRINKING_D = 0)</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Alcohol Involved<br>(DRINKING_D = 1)</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"2\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Predictor </th>\n   <th style=\"text-align:center;\"> N </th>\n   <th style=\"text-align:center;\"> % </th>\n   <th style=\"text-align:center;\"> N </th>\n   <th style=\"text-align:center;\"> % </th>\n   <th style=\"text-align:center;\"> Total </th>\n   <th style=\"text-align:center;\"> Œß2 p-value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> FATAL_OR_M </td>\n   <td style=\"text-align:center;\"> 1,181 </td>\n   <td style=\"text-align:center;\"> 2.89 </td>\n   <td style=\"text-align:center;\"> 188 </td>\n   <td style=\"text-align:center;\"> 7.57 </td>\n   <td style=\"text-align:center;\"> 1,369 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> OVERTURNED </td>\n   <td style=\"text-align:center;\"> 612 </td>\n   <td style=\"text-align:center;\"> 1.50 </td>\n   <td style=\"text-align:center;\"> 110 </td>\n   <td style=\"text-align:center;\"> 4.43 </td>\n   <td style=\"text-align:center;\"> 722 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> CELL_PHONE </td>\n   <td style=\"text-align:center;\"> 426 </td>\n   <td style=\"text-align:center;\"> 1.04 </td>\n   <td style=\"text-align:center;\"> 28 </td>\n   <td style=\"text-align:center;\"> 1.13 </td>\n   <td style=\"text-align:center;\"> 454 </td>\n   <td style=\"text-align:center;\"> 0.69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> SPEEDING </td>\n   <td style=\"text-align:center;\"> 1,261 </td>\n   <td style=\"text-align:center;\"> 3.08 </td>\n   <td style=\"text-align:center;\"> 260 </td>\n   <td style=\"text-align:center;\"> 10.46 </td>\n   <td style=\"text-align:center;\"> 1,521 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> AGGRESSIVE </td>\n   <td style=\"text-align:center;\"> 18,522 </td>\n   <td style=\"text-align:center;\"> 45.31 </td>\n   <td style=\"text-align:center;\"> 916 </td>\n   <td style=\"text-align:center;\"> 36.86 </td>\n   <td style=\"text-align:center;\"> 19,438 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> DRIVER1617 </td>\n   <td style=\"text-align:center;\"> 674 </td>\n   <td style=\"text-align:center;\"> 1.65 </td>\n   <td style=\"text-align:center;\"> 12 </td>\n   <td style=\"text-align:center;\"> 0.48 </td>\n   <td style=\"text-align:center;\"> 686 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> DRIVER65PLUS </td>\n   <td style=\"text-align:center;\"> 4,237 </td>\n   <td style=\"text-align:center;\"> 10.36 </td>\n   <td style=\"text-align:center;\"> 119 </td>\n   <td style=\"text-align:center;\"> 4.79 </td>\n   <td style=\"text-align:center;\"> 4,356 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Variable Definitions:</span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>FATAL_OR_M:</i> Crash resulted in fatality or major injury.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>OVERTURNED:</i> Crash involved an overturned vehicle.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>CELL_PHONE:</i> Driver was using cell phone.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>SPEEDING:</i> Crash involved speeding car.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>AGGRESSIVE:</i> Crash involved aggressive driving.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>DRIVER1617:</i> Crash involved at least one driver who was 16 or 17 years old.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>DRIVER65PLUS:</i> Crash involved at least one driver who was at least 65 years old.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Save as HTML file.\n#save_kable(cross_tab, \"cross_tabulation_table.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"cross_tabulation_table.html\", \"cross_tabulation_table.png\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split the data into groups.\nno_alcohol_means <- subset(mean_sd_table, Group == \"No Alcohol\")\nalcohol_means    <- subset(mean_sd_table, Group == \"Alcohol\")\n\n# Make wide.\nwide_means <- data.frame(\n  Predictor = no_alcohol_means$Predictor,\n  Mean_No   = no_alcohol_means$Mean,\n  SD_No     = no_alcohol_means$SD,\n  Mean_Yes  = alcohol_means$Mean,\n  SD_Yes    = alcohol_means$SD\n)\n\n# Merge with t-test results to get the p-value.\nfinal_means_data <- merge(wide_means, t_table[, c(\"Predictor\", \"p_value\")], by = \"Predictor\")\n\n# Create table.\nmeans_of_predictors <- kbl(final_means_data, \n    col.names = c(\"Predictor\", \"Mean\", \"SD\", \"Mean\", \"SD\", \"t-test p-value\"),\n    align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n    digits = 2,\n    row.names = FALSE,\n    format.args = list(big.mark = \",\"),\n    caption = \"Means of Predictors by Alcohol Involvement\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F) %>%\n  add_header_above(c(\" \" = 1, \"No Alcohol Involved\\n(DRINKING_D = 0)\" = 2, \"Alcohol Involved\\n(DRINKING_D = 1)\" = 2, \" \" = 1)) %>%\n  column_spec(1, bold = T) %>%\n  footnote(\n    general = c(\n      \"<i>PCTBACHMOR:</i> % with bachelor's degree or more.\",\n      \"<i>MEDHHINC:</i> Median household income.\"\n    ),\n    general_title = \"Variable Definitions:\",\n    footnote_as_chunk = FALSE, \n    escape = FALSE\n  )\n\nmeans_of_predictors\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Means of Predictors by Alcohol Involvement</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">No Alcohol Involved<br>(DRINKING_D = 0)</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Alcohol Involved<br>(DRINKING_D = 1)</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Predictor </th>\n   <th style=\"text-align:center;\"> Mean </th>\n   <th style=\"text-align:center;\"> SD </th>\n   <th style=\"text-align:center;\"> Mean </th>\n   <th style=\"text-align:center;\"> SD </th>\n   <th style=\"text-align:center;\"> t-test p-value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> MEDHHINC </td>\n   <td style=\"text-align:center;\"> 31,483.05 </td>\n   <td style=\"text-align:center;\"> 16,930.10 </td>\n   <td style=\"text-align:center;\"> 31,998.75 </td>\n   <td style=\"text-align:center;\"> 17,810.50 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> PCTBACHMOR </td>\n   <td style=\"text-align:center;\"> 16.57 </td>\n   <td style=\"text-align:center;\"> 18.21 </td>\n   <td style=\"text-align:center;\"> 16.61 </td>\n   <td style=\"text-align:center;\"> 18.72 </td>\n   <td style=\"text-align:center;\"> 0.91 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Variable Definitions:</span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>PCTBACHMOR:</i> % with bachelor's degree or more.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> <i>MEDHHINC:</i> Median household income.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Save as HTML file.\n#save_kable(means_of_predictors, \"means_of_predictors.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"means_of_predictors.html\", \"means_of_predictors.png\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find the index of the row with the minimum misclassification rate.\nbest_row <- which.min(cutoff_table$Misclass)\nworst_row <- which.max(cutoff_table$Misclass)\n\ncutoff_table <- kbl(cutoff_table, \n    digits = 2,\n    caption = \"Sensitivity, Specificity, and Misclassification Rates\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F) %>%\n  # Bold best row.\n  row_spec(best_row, bold = TRUE, color = \"black\") %>%\n  # Bold worst row.\n  row_spec(worst_row, bold = TRUE, color = \"black\")\n\ncutoff_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Sensitivity, Specificity, and Misclassification Rates</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Cutoff </th>\n   <th style=\"text-align:right;\"> Sensitivity </th>\n   <th style=\"text-align:right;\"> Specificity </th>\n   <th style=\"text-align:right;\"> Misclass </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.02 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.98 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.06 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.89 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.03 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n   <td style=\"text-align:right;\"> 0.06 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.05 </td>\n   <td style=\"text-align:right;\"> 0.73 </td>\n   <td style=\"text-align:right;\"> 0.47 </td>\n   <td style=\"text-align:right;\"> 0.52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> 0.22 </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> 0.18 </td>\n   <td style=\"text-align:right;\"> 0.94 </td>\n   <td style=\"text-align:right;\"> 0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.09 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.10 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n   <td style=\"text-align:right;\"> 0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.10 </td>\n   <td style=\"text-align:right;\"> 0.97 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 1.00 </td>\n   <td style=\"text-align:right;\"> 0.06 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.50 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.00 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 1.00 </td>\n   <td style=\"text-align:right;font-weight: bold;color: black !important;\"> 0.06 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Save as HTML file.\n#save_kable(cutoff_table, \"cutoff_table.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"cutoff_table.html\", \"cutoff_table.png\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate AIC for both models\naic_values <- AIC(logit_full, logit_reduced)\n\n# The AIC() function returns a dataframe with row names as the models.\n# Let's pretty it up for the table.\naic_table <- data.frame(\n  Model = c(\"Full Model (All Predictors)\", \"Reduced Model (Binary Only)\"),\n  df    = aic_values$df,\n  AIC   = aic_values$AIC\n)\n\naic_kable <- kbl(aic_table, \n    digits = 2,\n    col.names = c(\"Model\", \"Degrees of Freedom\", \"AIC\"),\n    align = c(\"l\", \"c\", \"c\"),\n    caption = \"Model Comparison: Akaike Information Criterion (AIC)\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\"), full_width = F) %>%\n  row_spec(which.min(aic_table$AIC), bold = T, color = \"black\") %>%\n  footnote(\n    general = c(\n      \"Lower AIC is better.\"\n    ),\n    general_title = \"Note:\",\n    footnote_as_chunk = FALSE, \n    escape = FALSE\n  )\n  \n\naic_kable\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Model Comparison: Akaike Information Criterion (AIC)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:center;\"> Degrees of Freedom </th>\n   <th style=\"text-align:center;\"> AIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: black !important;\"> Full Model (All Predictors) </td>\n   <td style=\"text-align:center;font-weight: bold;color: black !important;\"> 10 </td>\n   <td style=\"text-align:center;font-weight: bold;color: black !important;\"> 18359.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Reduced Model (Binary Only) </td>\n   <td style=\"text-align:center;\"> 8 </td>\n   <td style=\"text-align:center;\"> 18360.47 </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note:</span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Lower AIC is better.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Save as HTML file.\n#save_kable(aic_kable, \"aic_kable.html\", zoom = 3, self_contained = TRUE)\n\n# Then convert HTML to PNG using webshot.\n#webshot::webshot(\"aic_kable.html\", \"aic_kable.png\")\n```\n:::\n",
    "supporting": [
      "logistic_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}